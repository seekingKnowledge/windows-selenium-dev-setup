Hi @jimevans 
sorry for contact as such 
I use this code bellow to take full page screenshot but it does not take the whole page horizontally. could you please help me with this. p
im very new with this and im just learning for my course project please



	package Mytestpack;

	import java.io.File;

import javax.imageio.ImageIO;

import org.apache.commons.io.FileUtils;
	import org.openqa.selenium.By;
	import org.openqa.selenium.Dimension;
	import org.openqa.selenium.OutputType;
	import org.openqa.selenium.TakesScreenshot;
	import org.openqa.selenium.WebDriver;
	import org.openqa.selenium.chrome.ChromeDriver;
	import org.openqa.selenium.safari.*;
	import org.openqa.selenium.firefox.FirefoxDriver;
import org.openqa.selenium.opera.OperaDriver;
import org.openqa.selenium.remote.DesiredCapabilities;
	import org.openqa.selenium.remote.RemoteWebDriver;
	import org.openqa.selenium.edge.*;
	import org.testng.annotations.Test;

import ru.yandex.qatools.ashot.AShot;
import ru.yandex.qatools.ashot.Screenshot;
import ru.yandex.qatools.ashot.screentaker.ViewportPastingStrategy;
	     
	    public class mytestclass {
	        public WebDriver driver;
	        
	        public static void main(String[] args) {
	        	mytestclass main = new mytestclass();
	        	try {
					main.openBrowser();
				} catch (Exception e) {
					// TODO Auto-generated catch block
					e.printStackTrace();
				}
	        }
	        
	        public void getscreenshot2() throws Exception {
	        	 //take the screenshot of the entire home page and save it to a png file
	        	//
	        	 Screenshot screenshot = new AShot().shootingStrategy(new ViewportPastingStrategy(1500)).takeScreenshot(driver);
	        	 ImageIO.write(screenshot.getImage(), "PNG", new File("C:\\Temp\\screenshot.PNG"));
	        	 
	        }
	        
	         
	      @Test
	      public void openBrowser() throws Exception {
	    	  // C:\Webdriverwork\testproject\chromedriver_win32
	    	  // ChromeDriver ,,  "http://localhost:9515", DesiredCapabilities.chrome()
	    	  // http://www.bbc.co.uk/ http://www.google.com
	    	  System.setProperty("webdriver.opera.driver", "C:/Webdriverwork/testproject/operadriver.exe");
	    	  driver = new OperaDriver();
	    	  //EdgeOptions options = new EdgeOptions();
	    	  //options.setPageLoadStrategy( "eager");
	    	  //driver = new EdgeDriver(options);
	    	  driver.manage().window().maximize();
	    	  Dimension dimension = new Dimension(1000, 4000);
	    	  //driver.manage().window().
	    	  driver.get("http://www.qmul.ac.uk/");
	    	  //driver.manage().window().setSize(dimension);
	    	  //Thread.sleep(10000);
	    	  try{
	                //the below statement will throw an exception as the element is not found, Catch block will get executed and takes the screenshot.
	    		  driver.findElement(By.id("testing")).sendKeys("test");
	                 
	                   //if we remove the below comment, it will not return exception and screen shot method will not get executed.
	    		  //driver.findElement(By.id("gbqfq")).sendKeys("test");
	    	  }
	    	  catch (Exception e){
	    		  System.out.println("I'm in exception");
	//calls the method to take the screenshot.
	    		  getscreenshot2();
	    		  driver.quit();
	     	  }
	      }
	      
	      public void getscreenshot() throws Exception 
	      {
	              File scrFile = ((TakesScreenshot)driver).getScreenshotAs(OutputType.FILE);
	           //The below method will save the screen shot in d drive with name "screenshot.png"
	              FileUtils.copyFile(scrFile, new File("C:\\Temp\\screenshot.png"));
	      }
	 }
Â© 2016 Microsoft Terms Privacy & cookies Developers English (United Kingdom)
